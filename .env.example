# ╔══════════════════════════════════════════════════════════════╗
# ║            THERMODUCT PORTAL — CONFIGURATION               ║
# ╠══════════════════════════════════════════════════════════════╣
# ║  Copy to .env and adjust values for your environment.       ║
# ║  All WEBHOOK_ paths are relative to API_BASE_URL unless     ║
# ║  they start with http(s)://.                                ║
# ╚══════════════════════════════════════════════════════════════╝

# ── App Settings ──────────────────────────────────────────────
APP_TITLE=Thermoduct Portal
APP_PORT=8080

# ── Authentication (Keycloak OIDC + PKCE) ────────────────────
# The portal redirects to Keycloak for login. No client secret needed.
# Keycloak handles username/password, MFA, SSO, etc.
#
#   FLOW:
#   Browser → Keycloak login page → callback.html → tokens in sessionStorage
#
AUTH_ISSUER=https://auth.thermoduct.elementium.be/realms/thermoduct
AUTH_CLIENT_ID=installer-portal
AUTH_REDIRECT_URI=https://portal.thermoduct.elementium.be/callback.html
AUTH_POST_LOGOUT_URI=https://portal.thermoduct.elementium.be/index.html
AUTH_SCOPES=openid profile email roles

# ── API Base URL ─────────────────────────────────────────────
# All webhook paths below are appended to this base
API_BASE_URL=https://46.225.76.46/n8n/webhook

# ── Outgoing Webhooks (n8n) ──────────────────────────────────
#
#   PATHWAY                          METHOD   AUTH     DESCRIPTION
#   ─────────────────────────────    ──────   ──────   ───────────────────────────────
#   {WEBHOOK_TASKS}/tasks            GET      Bearer   List all tasks for logged-in user
#   {WEBHOOK_TASKS}/task/{id}        GET      Bearer   Single task detail + PDFs
#   {WEBHOOK_FOLDERS}?project_id=    GET      Bearer   Folder tree (Gebouw/Verdiep/Collector)
#   {WEBHOOK_FILES}?project_id=&..   GET      Bearer   List files in a folder
#   {WEBHOOK_SERVE_FILE}?..          GET      —        Serve/download a file (public)
#   {WEBHOOK_FILE_DELETE}            POST     Bearer   Delete a file { project_id, folder_path, file_name }
#   {WEBHOOK_UPLOAD_FORM}?..         GET      —        Opens n8n upload form in popup
#
# ── Incoming to this portal ──────────────────────────────────
#
#   PATH                  FROM         DESCRIPTION
#   ────────────────────  ───────────  ─────────────────────────────────────
#   /                     Browser      Main app (index.html)
#   /callback.html        Keycloak     OIDC redirect after login (exchanges code for tokens)
#

# Tasks — full URL (new n8n instance with Keycloak auth subflow)
WEBHOOK_TASKS=https://n8n.thermoduct.elementium.be/webhook
WEBHOOK_FOLDERS=/thermoduct-folders
WEBHOOK_FILES=/thermoduct-files
WEBHOOK_SERVE_FILE=/thermoduct-serve-file
WEBHOOK_FILE_DELETE=/thermoduct-file-delete

# Upload form — full URL (different base path: /n8n/form/)
WEBHOOK_UPLOAD_FORM=https://46.225.76.46/n8n/form/c939dab0-c13d-4f51-95b7-50ddc4068880

# PDF upload — project leaders upload plans to Odoo (POST, Bearer auth)
WEBHOOK_PDF_UPLOAD=/thermoduct-pdf-upload
